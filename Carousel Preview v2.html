<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Carousel JSON Generator</title>
  <style>
    :root {
      --bg: #ffffff;
      --fg: #1a1a1a;
      --border: #dddddd;
      --accent: #007BFF;
      --section-bg: #f8f9fa;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--fg);
      margin: 20px;
    }
    h2, h3 { margin-top: 1.5em; }
    input, textarea, select, button {
      display: block;
      margin-bottom: 10px;
      padding: 8px;
      font-size: 14px;
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 4px;
    }
    label { font-weight: bold; margin-top: 10px; }
    button {
      cursor: pointer;
      background-color: var(--accent);
      color: white;
      border: none;
      border-radius: 4px;
      padding: 10px;
    }
    .section, .card {
      background: var(--section-bg);
      border: 1px solid var(--border);
      border-radius: 5px;
      padding: 15px;
      margin-bottom: 20px;
    }
    .json-output {
      white-space: pre-wrap;
      background: #f1f3f5;
      padding: 15px;
      font-family: monospace;
      border: 1px solid var(--border);
      border-radius: 5px;
    }
    .card-header {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h2>üõ† Carousel JSON Generator</h2>

  <div class="section">
    <label>Name:</label>
    <input type="text" id="name" value="carousel_24_may">
    <label>Language:</label>
    <input type="text" id="language" value="de">
    <label>Category:</label>
    <input type="text" id="category" value="MARKETING">
  </div>

  <div class="section">
    <h3>‚úèÔ∏è Main BODY Component</h3>
    <label>Body Text:</label>
    <textarea id="mainBodyText">Hi {{1}} üòä, schau dir die neuen Schn√§ppchen f√ºr die kommende Woche an!</textarea>
    <label>Number of placeholders (e.g. {{1}}, {{2}}):</label>
    <input type="number" id="placeholderCount" value="1" min="1" max="10">
    <div id="exampleInputs"></div>
  </div>

  <div class="section">
    <h3>üñºÔ∏è Carousel Cards</h3>
    <div id="cardsContainer"></div>
    <button onclick="addCard()">‚ûï Add Card</button>
  </div>

  <div class="section">
    <h3>üßæ Generated JSON</h3>
    <div class="json-output" id="jsonOutput"></div>
    <button onclick="copyJSON()">üìã Copy JSON</button>
  </div>

  <script>
    const cardsContainer = document.getElementById('cardsContainer');
    const jsonOutput = document.getElementById('jsonOutput');
    const placeholderCount = document.getElementById('placeholderCount');
    const exampleInputs = document.getElementById('exampleInputs');

    function createExampleFields(count) {
      exampleInputs.innerHTML = '';
      for (let i = 1; i <= count; i++) {
        const label = document.createElement('label');
        label.textContent = `Example for {{${i}}}:`;
        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'exampleInput';
        input.dataset.index = i - 1;
        input.placeholder = `Example value for {{${i}}}`;
        input.addEventListener('input', updateJSON);
        exampleInputs.appendChild(label);
        exampleInputs.appendChild(input);
      }
    }

    placeholderCount.addEventListener('input', () => {
      const count = parseInt(placeholderCount.value);
      createExampleFields(count);
      updateJSON();
    });

    function addCard(image = '', body = '', buttonText = '', buttonURL = 'https://www.netto-online.de/', exampleURL = '', includeVar = true) {
      const cardDiv = document.createElement('div');
      cardDiv.className = 'card';
      cardDiv.innerHTML = `
        <div class="card-header">üÉè Carousel Card</div>
        <label>Image URL:</label>
        <input type="text" class="image" value="${image}">
        <label>Body Text:</label>
        <textarea class="body">${body}</textarea>
        <label>Button Text:</label>
        <input type="text" class="buttonText" value="${buttonText}">
        <label>Include {{1}} in URL?</label>
        <input type="checkbox" class="includeVar" ${includeVar ? 'checked' : ''}>
        <label>Button URL:</label>
        <input type="text" class="buttonURL" value="${buttonURL}">
        <div class="exampleURLSection" style="display: ${includeVar ? 'block' : 'none'}">
          <label>Example URL:</label>
          <input type="text" class="exampleURL" value="${exampleURL}">
        </div>
        <button onclick="removeCard(this)">‚ùå Remove</button>
      `;
      cardsContainer.appendChild(cardDiv);
      cardDiv.querySelectorAll('input, textarea').forEach(input => input.addEventListener('input', updateJSON));
      cardDiv.querySelector('.includeVar').addEventListener('change', function () {
        const exampleSection = cardDiv.querySelector('.exampleURLSection');
        exampleSection.style.display = this.checked ? 'block' : 'none';
        updateJSON();
      });
      updateJSON();
    }

    function removeCard(button) {
      button.parentElement.remove();
      updateJSON();
    }

    function updateJSON() {
      const name = document.getElementById('name').value;
      const language = document.getElementById('language').value;
      const category = document.getElementById('category').value;
      const mainBodyText = document.getElementById('mainBodyText').value;

      const exampleValues = Array.from(document.querySelectorAll('.exampleInput')).map(input => input.value);
      const bodyExample = [exampleValues];

      const cards = [];
      document.querySelectorAll('.card').forEach(card => {
        const image = card.querySelector('.image').value;
        const body = card.querySelector('.body').value;
        const buttonText = card.querySelector('.buttonText').value;
        const buttonURL = card.querySelector('.buttonURL').value;
        const includeVar = card.querySelector('.includeVar').checked;
        const exampleURL = card.querySelector('.exampleURL').value;

        const cardObj = {
          components: [
            {
              type: "header",
              format: "image",
              example: {
                header_handle: [image]
              }
            },
            {
              type: "BODY",
              text: body
            },
            {
              type: "buttons",
              buttons: [
                {
                  type: "url",
                  text: buttonText,
                  url: buttonURL
                }
              ]
            }
          ]
        };

        if (includeVar) {
          cardObj.components[2].buttons[0].example = [exampleURL];
        }

        cards.push(cardObj);
      });

      const result = {
        name,
        language,
        category,
        components: [
          {
            type: "BODY",
            text: mainBodyText,
            example: {
              body_text: bodyExample
            }
          },
          {
            type: "CAROUSEL",
            cards
          }
        ]
      };

      jsonOutput.textContent = JSON.stringify(result, null, 2);
    }

    function copyJSON() {
      navigator.clipboard.writeText(jsonOutput.textContent).then(() => {
        alert("‚úÖ JSON copied!");
      });
    }

    // Initialize
    createExampleFields(parseInt(placeholderCount.value));
    addCard();
    document.getElementById('mainBodyText').addEventListener('input', updateJSON);
  </script>
</body>
</html>
